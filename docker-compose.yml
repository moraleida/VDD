###############################################################################
# Varying Docker Dockers                                                      #
# Author: Ricardo Moraleida                                                   #
#                                                                             #
# Main configuration file. This is where we choose the containers that we'll  #
# tie together to form our environment and build their relations.             #
#                                                                             #
# Ref.: https://docs.docker.com/v1.5/compose/yml/                             #  
###############################################################################

## It all starts with the base container. This is the container you'll be using
## to access the services you need.
base:
  build: base
  stdin_open: true
  volumes_from:
    - htdocs:rw
  links:
    - node
server:
  build: nginx-fpm
  links:
    - php
    - memcached
  ports:
    - "80:80"
    - "443:443"
  volumes_from:
    - base:rw
memcached:
  image: memcached
  ports:
    - "11211:11211"
php:
  build: php-5.6-fpm-custom
  volumes_from:
    - base:rw
    - db
db:
  image: mariadb
  ports:
    - "3306:3306"
  volumes:
    - /var/run/mysqld
  environment:
    MYSQL_ROOT_PASSWORD: root
node:
  image: node
htdocs:
  build: base
  volumes:
    - ./htdocs:/var/www/html
